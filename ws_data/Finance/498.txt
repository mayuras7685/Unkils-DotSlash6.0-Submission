We develop an analytical solution to the dynamic portfolio choice problem of an investor with power utility defined over wealth at a finite horizon who faces an investment opportunity set with time-varying risk premia, real interest rates and inflation. The variation in investment opportunities is captured by a flexible vector autoregressive parameterization, which readily accommodates a large number of assets and state variables. We find that the optimal dynamic portfolio strategy is an affine function of the vector of state variables describing investment opportunities, with coefficients that are a function of the investment horizon. We apply our method to the optimal portfolio choice problem of an investor who can choose between value and growth stock portfolios, and among these equity portfolios plus bills and bonds. For equity-only investors, the optimal mean allocation of short-horizon investors is heavily tilted away from growth stocks regardless of their risk aversion. However, the mean allocation to growth stocks increases dramatically with the investment horizon, implying that growth is less risky than value at long horizons for equity-only investors. Long-horizon aggressive investors who have access to bills and bonds increase their allocation to both value stocks and growth stocks at long horizons, but they do not actively tilt their portfolios toward growth stocks. These investors increase their allocation to growth stocks as a result of their desire to optimally increase their overall allocation to equities. We also explore the welfare implications of adopting the optimal dynamic rebalancing strategy vis a vis other policies that revise portfolio weights infrequently, and find significant welfare gains from continuous rebalancing for all long-horizon investors. 